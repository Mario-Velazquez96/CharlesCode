<template>
  <lightning-card title="User call detail overview">
    <lightning-layout multiple-rows="true">
      <lightning-layout-item size="8"
        ><c-user-call-look-up
          obj-name="User"
          search-placeholder="Search Users"
          icon-name="standard:user"
          onrecordsearch={searchCalls}
          onrecordremove={cleanCalls}
        >
        </c-user-call-look-up>
      </lightning-layout-item>
      <template if:true={showSummary}>
        <lightning-layout-item size="12" class="slds-p-around_small">
          <div class="card-container">
            <lightning-card title="Summary" icon-name="standard:metrics">
              <lightning-layout multiple-rows="true">
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Call amount"
                    description="Date range selected"
                    value={callTotalAmount}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Number of days calling"
                    description="Date range selected"
                    value={numberOfDaysCalling}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Call this week"
                    description="This week"
                    value={callDetailThisWeekSize}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Call last week"
                    description="Last week"
                    value={callDetailsLastWeekSize}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Call this month"
                    description="This Month"
                    value={callDetailsThisMonthSize}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Call last month"
                    description="Last Month"
                    value={callDetailsLastMonthSize}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Meetings amount"
                    description="Date range selected"
                    value={meetingsDetailsDateRangeSize}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label="Scheduled meetings by self"
                    description="Date range selected"
                    value={meetingsScheduledBySelf}
                  ></c-metric-container>
                </lightning-layout-item>
                <lightning-layout-item size="3" class="slds-p-around_small">
                  <c-metric-container
                    label-font-size=".8rem"
                    label="Scheduled meetings by others"
                    description="Date range selected"
                    value={meetingsScheduledByOthers}
                  ></c-metric-container>
                </lightning-layout-item>
              </lightning-layout>
            </lightning-card>
          </div>
        </lightning-layout-item>

        <lightning-layout-item
          size="12"
          class="slds-p-horizontal_small slds-p-bottom_small"
        >
          <div class="card-container">
            <lightning-card title="Markets" icon-name="standard:metrics">
              <lightning-layout multiple-rows="true">
                <template lwc:if={isThereMarkets}>
                  <template for:each={marketData} for:item="market">
                    <lightning-layout-item
                      key={market.key}
                      size="2"
                      class="slds-p-around_small"
                    >
                      <c-metric-container
                        label={market.key}
                        description=" "
                        value={market.value}
                      ></c-metric-container>
                    </lightning-layout-item>
                  </template>
                </template>
                <template lwc:elseif={isThereNoMarkets}>
                  <lightning-layout-item size="12" class="slds-p-around_small">
                    <p>No markets found</p>
                  </lightning-layout-item>
                </template>
              </lightning-layout>
            </lightning-card>
          </div>
        </lightning-layout-item>

        <lightning-layout-item
          size="12"
          class="slds-p-horizontal_small slds-p-bottom_small"
        >
          <div class="card-container">
            <lightning-card title="Titles" icon-name="standard:metrics">
              <lightning-layout multiple-rows="true">
                <template lwc:if={isThereTitles}>
                  <template for:each={titleData} for:item="title">
                    <lightning-layout-item
                      key={title.key}
                      size="2"
                      class="slds-p-around_small"
                    >
                      <c-metric-container
                        label={title.key}
                        description=" "
                        value={title.value}
                      ></c-metric-container>
                    </lightning-layout-item>
                  </template>
                </template>
                <template lwc:elseif={isThereNoTitles}>
                  <lightning-layout-item size="12" class="slds-p-around_small">
                    <p>No titles found</p>
                  </lightning-layout-item>
                </template>
              </lightning-layout>
            </lightning-card>
          </div>
        </lightning-layout-item>

        <lightning-layout-item
          size="12"
          class="slds-p-horizontal_small slds-p-bottom_small"
        >
          <div class="card-container">
            <lightning-card title="Details" icon-name="standard:metrics">
              <lightning-layout multiple-rows="true">
                <lightning-layout-item size="12" class="slds-p-around_small">
                  <c-avonni-summary-detail>
                    <h3
                      slot="title"
                      class="slds-text-heading_small slds-truncate slds-p-right_small"
                      title="summary title"
                    >
                      Calls Details
                    </h3>
                    <template lwc:if={isThereCalls}>
                      <c-user-call-data-table
                        record-list={callDetailsDateRange}
                        columns={taskColumns}
                        sorted-by="CreatedDate"
                        sort-direction="desc"
                      >
                      </c-user-call-data-table>
                    </template>
                    <template lwc:elseif={isThereNoCalls}>
                      <p>No calls found</p>
                    </template>
                  </c-avonni-summary-detail>
                </lightning-layout-item>
                <lightning-layout-item size="12" class="slds-p-around_small">
                  <c-avonni-summary-detail>
                    <h3
                      slot="title"
                      class="slds-text-heading_small slds-truncate slds-p-right_small"
                      title="summary title"
                    >
                      Meetings Details
                    </h3>
                    <template lwc:if={isThereMeetings}>
                      <c-user-call-data-table
                        record-list={meetingsDetailsDateRange}
                        columns={meetingColumns}
                        sorted-by="CreatedDate"
                        sort-direction="desc"
                      >
                      </c-user-call-data-table>
                    </template>
                    <template lwc:elseif={isThereNoMeetings}>
                      <p>No meetings found</p>
                    </template>
                  </c-avonni-summary-detail>
                </lightning-layout-item>
              </lightning-layout>
            </lightning-card>
          </div>
        </lightning-layout-item>
      </template>
    </lightning-layout>
  </lightning-card>
  <template if:true={loading}>
    <lightning-spinner
      alternative-text="Loading"
      size="large"
    ></lightning-spinner>
  </template>
</template>
